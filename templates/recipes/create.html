{% extends 'base/recipes.html' %}
{% load static %}
{% load widget_tweaks %}
{% block hero_title %}Create a recipe{% endblock %}
{% block page_title %}Create a recipe{% endblock %}
{% block content_page_name %}Create a recipe{% endblock %}
{% block content_deps %}
    <script src="https://unpkg.com/vue-slicksort@latest/dist/vue-slicksort.min.js"></script>
    <link rel="stylesheet" href="{% static 'css/recipe/crud.css'%} ">
{#<script src="{% static 'js/components/ingredients.js' %}"></script>#}
    <script src="{% static 'js/bundle.js' %}"></script>
{% endblock %}
{% block page_content %}
    <form method="post" novalidate action="{{ request.path }}">
        <div class="columns">
        <div class="column"><div class="form-group field is-horizontal recipe-underlined-input-field">
        <div class="field-label is-medium">
            <label class="label">{{ form.name.label_tag }}</label>
        </div>
        <div class="field-body">
<div class="field is-expanded">

            <b-input custom-class="recipe-underlined-input has-text-weight-bold is-size-3{% if form.name.errors %} is-danger{% endif %}" name="{{ form.name.name }}"
                     placeholder="Name your delish recipe!"
                size="is-large"
                     type="text">
            </b-input>
            {% if form.name.errors %}
            {% for error in form.name.errors %}
            <p class="help is-danger">
                {{ error }}
            </p>
            {% endfor %}
            {% endif %}
        </div>
        </div>
    </div></div>
        </div>
        <div class="columns">
            <div class="column">
                <image-holder></image-holder>
            </div>
            <div class="column"><b-tabs position="is-centered">
        <b-tab-item label="Ingredients" icon="food-croissant">
            <ingredient-chooser :selectable-units="selectableUnits"></ingredient-chooser>
        </b-tab-item>
        <b-tab-item label="Instructions" icon="view-headline">
                <instruction-list></instruction-list>
        </b-tab-item>
    </b-tabs></div>
        </div>


{#    <input name="ingredients" type="hidden" :value="JSON.stringify(ingredients)">#}

    <div class="form-group field is-horizontal">
        <div class="field-label is-medium">
            <label class="label">{{ form.author.label_tag }}</label>
        </div>
        <div class="field-body">
            <div class="field control"> {{ form.author|add_class:"input is-medium" }}
            </div>
            {% if form.author.errors %}
            {% for error in form.author.errors %}
            <div class="invalid-feedback">
                {{ error }}
            </div>
            {% endfor %}
            {% endif %}
        </div>
    </div>
    {% csrf_token %}
     {% for error in form.image.errors %}
            <div class="invalid-feedback">
                {{ error }}
            </div>
            {% endfor %}
    {% for field in form.vanilla_fields %}
        {% if field.is_hidden %}
            {{ field }}

            {% else %}
    <div class="form-group field is-horizontal">
        <div class="field-label is-normal">
            <label class="label">{{ field.label_tag }}</label>
        </div>
        <div class="field-body">
            <div class="field control"> {{ field|add_class:"input is-normal" }}
            </div>
            {% if field.errors %}
            {% for error in field.errors %}
            <div class="invalid-feedback">
                {{ error }}
            </div>
            {% endfor %}
            {% endif %}
        </div>
    </div>
        {% endif %}
    {% endfor %}
    <div class="field is-horizontal">
        <div class="field-label">
            <!-- Left empty for spacing -->
        </div>
        <div class="field-body">
            <div class="field">
                <div class="control">
                    <button type="submit" class="button is-success">
                        Create
                    </button>
                </div>
            </div>
        </div>
    </div>
    </form>

     <script>
      new Vue({
        el: '#app',
        data: {
            searchName: '',
            ingredients: [],
            unitConversionFactor: CONVERSION_FACTORS,
            selectableUnits: CONVERSION_UNITS
        }
      })
  </script>
{% endblock %}
